# 报警服务使用指南 {#concept_opj_kzj_5db .concept}

在介绍OSS监控服务控制台之前，请先阅读云监控提供的监控服务文档，了解基本概念并进行报警联系人和报警联系组的配置。

-   [报警服务概览](https://help.aliyun.com/document_detail/28608.html)
-   [报警联系人和联系组](https://help.aliyun.com/document_detail/28609.html)

因为OSS的报警规则是根据OSS监控项设置的，所以类似于OSS监控项的维度分类，将其分成两个报警维度：用户层级和Bucket层级。

## 报警规则页 {#section_nf3_4zj_5db .section}

报警规则页是OSS监控报警相关的规则管理页面，您可以查看、修改、启用、禁用和删除对应的报警规则，而且能够查看该对应报警规则的历史报警情况。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/1216_zh-CN.png)

-   点击对应报警规则的**修改**，就可以对该报警规则进行修改。
-   点击对应报警规则的**删除**，就可以删除该报警规则。选中多条报警规则，然后点击表格最下方的**删除**按钮，可以批量删除报警规则。
-   如果报警规则处于已启用状态，点击该报警规则的**禁用**，可以禁用该报警规则，报警规则失效，用户不能再收到对应的告警信息。选中多条报警规则，然后点击表格最下方的**禁用**按钮，可以批量禁用报警规则。
-   如果报警规则处于已禁用状态，点击该报警规则的**启用**，可以启用该报警规则，报警规则重新生效，能检测并发出对应的告警信息。选中多条报警规则，然后点击表格最下方的**启用**按钮，可以批量启用报警规则。
-   点击对应报警规则的**报警历史**，可以查看该报警规则历史发生的所有的告警情况。

这里解释一下报警历史的相关概念:

-   报警历史指的是该报警规则的状态变化历史，比如从正常变成告警状态，是一个状态变化；从告警变成正常也是状态变化。另外，还有一个特殊的状态变化：通道沉默。
-   当通知对象为**通道沉默**时，表示该报警规则触发告警之后的24小时内一直满足报警触发状态\(即一直在告警，没有恢复到正常状态\)。这个时候系统是不会再向用户发送告警信息进行通知的，一直持续到24小时之后才会有新的报警信息发送到通知对象。
-   报警历史信息能够保存一个月，即一个月之前的告警信息会被自动清理。查询时一次最多只能查询3天的数据，但不支持查询31天前的数据。

另外，点击具体报警规则的通知对象旁边的**查看**，可以显示该通知对象（报警联系组）的成员以及每个成员接收告警信息的方式（短信、邮箱或者旺旺）。

如何快速定位报警规则

根据报警规则页中的下面控件信息能够快速定位到被搜索的报警规则:

-   报警维度下拉框: 全部和Bucket层级。当选项为全部时，显示所有用户层级和Bucket层级的报警规则。

-   Bucket下拉框：当报警维度下拉框为Bucket层级时，这里可以罗列该用户的Bucket。选择对应的Bucket，可以展示属于该Bucket的所有报警规则。
-   监控项下拉框：罗列所有的OSS的监控项，包括用户层级和Bucket层级的监控项。当选项为监控项时，显示用户层级或者Bucket层级所有监控项的报警规则。
-   报警状态下拉框：报警状态、告警和正常。当为报警状态时显示所有状态的报警规则。
-   启用状态下拉框：启用状态、已禁用和已启用。当为启用状态时，显示所有状态的报警规则。

-   查看全部报警规则

    点击**报警规则**Tab页进入报警规则也默认显示全部报警规则。将报警维度下拉框设置为全部，即能显示全部报警规则。配合监控项、报警状态和启用状态这三个下拉框能够更精确定位全部维度下的报警规则。

-   查看特定Bucket的报警规则

    如果需要查看某个特定的Bucket的报警规则，需要设置报警维度下拉框为Bucket层级，然后在Bucket下拉框中选择对应的Bucket名称。通过**Bucket列表**中的对应Bucket的**报警规则**进入的报警页，就能显示该Bucket的所有的报警规则。配合监控项、报警状态和启用状态这三个，即能显示该报警维度下更精确的报警规则。

-   查看与具体监控项相关的报警规则

    设置监控项下拉框为具体的某项监控项，就能显示对应监控项的所有报警规则。

-   查看指定报警状态的报警规则

    设置报警状态下拉框为指定报警状态，如告警，就能展示所有处于该告警状态的报警规则。

-   查看指定启用状态的报警规则

    设置启动状态下拉框为指定启用状态，如已禁用，就能显示已经被禁用的所有的报警规则。


如何添加报警规则

在Bucket列表Tab页选中指定的Bucket之后点击**设置报警规则**按钮，或者在用户概况Tab页亦或某个Bucket监控视图页中的监控图形上的![](https://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/internal/oss/0.0.4/assets/image/media/alert_chart.jpg)都可以打开**批量设置报警规则**窗口，进行报警规则的设置。

下面演示一下报警规则设置的过程（注意，下面出现的名词概念请详见云监控[报警服务概览](https://help.aliyun.com/document_detail/28608.html)。）

1.  首先进入如下**设置报警规则**步骤：

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/1217_zh-CN.jpg)

    -   报警维度: 提示用户目前设置的报规则属于哪个维度的监控。如果是Bucket层级，则会提示目前为哪个具体的Bucket设置报警规则，图例中显示的是为用户层级。
    -   监控项: 该多选框显示属于该报警维度的所有的监控项选项。可以通过快速搜索框迅速定位：

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/1218_zh-CN.jpg)

    -   统计周期: 间隔多久进行一次数据统计，默认为5min。
    -   连续次数: 指连续几个统计周期监控项的值持续超过阈值后触发报警。
    -   统计方法: 指定该监控项中的具体的统计指标，OSS监控服务的统计方法均为监控值。
    -   添加报警规则按钮: 点击按钮可以设置更多监控项的报警规则。
    -   删除: 点击对应报警规则后的**删除**，可以删除该报警规则。
2.  设置完成之后，点击**下一步**，进入**设置通知对象**步骤，如下图：

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/1219_zh-CN.jpg)

    如果事先已经按照[报警联系人和联系组](https://help.aliyun.com/document_detail/28609.html)设置好报警联系组，那么就会像图例中展示出已经存在的报警联系人组。如果没有设置过报警联系人组，则点击**快创建联系人组**，按照提示创建即可。

3.  点击**确定**，完成报警规则的设置。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/1220_zh-CN.jpg)


-   Bucket列表添加报警规则

    在Bucket列表Tab页中可以为多个Bucket批量添加相同的报警规则。选中需要配置报警规则的Bucket，点击**设置报警规则**按钮，进入报警规则设置页面。

    **说明：** 批量设置时报警维度是确定的，监控项都是Bucket层级的。

-   具体监控图表中添加报警规则

    在用户概况Tab页或者具体Bucket的监控视图页中，点击具体的监控图右上方的![](https://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/internal/oss/0.0.4/assets/image/media/alert_chart.jpg)可以为该监控图用的监控指标项设置报警规则。

    **说明：** 通过点击监控图的报警图标进入报警规则页面时，报警维度都是确定的，而且只能设置该图中的监控项的报警规则。


## 注意事项 {#section_jt1_x2k_5db .section}

目前属于某个Bucket的报警规则存在性并没有与该Bucket的存在性强关联，即如果删除了某个Bucket，属于这个Bucket的报警规则依赖存在。建议用户在删除Bucket之前先删除对应的报警规则。

